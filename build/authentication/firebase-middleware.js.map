{"version":3,"sources":["../../src/authentication/firebase-middleware.js"],"names":["authService","requiresAuth","req","res","next","idToken","header","decodedIdToken","verifyIdToken","error","status","user"],"mappings":";;;;;;AAAA;;AACA,MAAMA,WAAW,GAAG,0BAApB;kBAEe;AACX,QAAMC,YAAN,CAAmBC,GAAnB,EAAwBC,GAAxB,EAA6BC,IAA7B,EAAmC;AAC/B,UAAMC,OAAO,GAAGH,GAAG,CAACI,MAAJ,CAAW,qBAAX,CAAhB,CAD+B,CAG/B;;AACA,QAAIC,cAAJ;;AAEA,QAAI;AACAA,MAAAA,cAAc,GAAG,MAAMP,WAAW,CAACQ,aAAZ,CAA0BH,OAA1B,CAAvB;AACH,KAFD,CAEE,OAAOI,KAAP,EAAc;AACZA,MAAAA,KAAK,CAACC,MAAN,GAAe,GAAf;AACAN,MAAAA,IAAI,CAACK,KAAD,CAAJ;AACA;AACH;;AAEDP,IAAAA,GAAG,CAACS,IAAJ,GAAWJ,cAAX;AACAH,IAAAA,IAAI;AACP;;AAjBU,C","sourcesContent":["import { auth } from 'firebase-admin';\nconst authService = auth();\n\nexport default {\n    async requiresAuth(req, res, next) {\n        const idToken = req.header('FIREBASE_AUTH_TOKEN');\n    \n        // https://firebase.google.com/docs/reference/admin/node/admin.auth.DecodedIdToken\n        let decodedIdToken;\n    \n        try {\n            decodedIdToken = await authService.verifyIdToken(idToken);\n        } catch (error) {\n            error.status = 403;\n            next(error);\n            return;\n        }\n    \n        req.user = decodedIdToken;\n        next();\n    }\n}"],"file":"firebase-middleware.js"}