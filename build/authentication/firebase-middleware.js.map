{"version":3,"sources":["../../src/authentication/firebase-middleware.js"],"names":["require","auth","authService","exports","requiresAuth","req","res","next","idToken","header","decodedIdToken","verifyIdToken","user"],"mappings":";;;;eAAeA,QAAQ,gBAAR,C;IAARC,I,YAAAA,I;;AACP,IAAMC,cAAcD,MAApB;;AAEAE,QAAQC,YAAR;AAAA,uEAAuB,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACbC,+BADa,GACHH,IAAII,MAAJ,CAAW,qBAAX,CADG;;AAGnB;;AACIC,sCAJe;AAAA;AAAA;AAAA,+BAOQR,YAAYS,aAAZ,CAA0BH,OAA1B,CAPR;;AAAA;AAOfE,sCAPe;AAAA;AAAA;;AAAA;AAAA;AAAA;;AASfH;AATe;;AAAA;;AAanBF,4BAAIO,IAAJ,GAAWF,cAAX;AACAH;;AAdmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAvB;;AAAA;AAAA;AAAA;AAAA","file":"firebase-middleware.js","sourcesContent":["const {auth} = require('firebase-admin');\nconst authService = auth();\n\nexports.requiresAuth = async (req, res, next) => {\n    const idToken = req.header('FIREBASE_AUTH_TOKEN');\n\n    // https://firebase.google.com/docs/reference/admin/node/admin.auth.DecodedIdToken\n    let decodedIdToken;\n\n    try {\n        decodedIdToken = await authService.verifyIdToken(idToken);\n    } catch (error) {\n        next(error);\n        return;\n    }\n\n    req.user = decodedIdToken;\n    next();\n}"]}