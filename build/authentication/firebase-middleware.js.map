{"version":3,"sources":["../../src/authentication/firebase-middleware.js"],"names":["requiresAuth","req","res","next","idToken","header","decodedIdToken","authService","verifyIdToken","error","status","user"],"mappings":";;;;;;AAAA;;AACA;kBAEe;AACX,QAAMA,YAAN,CAAmBC,GAAnB,EAAwBC,GAAxB,EAA6BC,IAA7B,EAAmC;AAC/B,UAAMC,OAAO,GAAGH,GAAG,CAACI,MAAJ,CAAW,qBAAX,CAAhB,CAD+B,CAG/B;;AACA,QAAIC,cAAJ;;AAEA,QAAI;AACAA,MAAAA,cAAc,GAAG,MAAMC,WAAW,CAACC,aAAZ,CAA0BJ,OAA1B,CAAvB;AACH,KAFD,CAEE,OAAOK,KAAP,EAAc;AACZA,MAAAA,KAAK,CAACC,MAAN,GAAe,GAAf;AACAP,MAAAA,IAAI,CAACM,KAAD,CAAJ;AACA;AACH;;AAEDR,IAAAA,GAAG,CAACU,IAAJ,GAAWL,cAAX;AACAH,IAAAA,IAAI;AACP;;AAjBU,C","sourcesContent":["import { auth } from 'firebase-admin';\n//const authService = auth();\n\nexport default {\n    async requiresAuth(req, res, next) {\n        const idToken = req.header('FIREBASE_AUTH_TOKEN');\n    \n        // https://firebase.google.com/docs/reference/admin/node/admin.auth.DecodedIdToken\n        let decodedIdToken;\n    \n        try {\n            decodedIdToken = await authService.verifyIdToken(idToken);\n        } catch (error) {\n            error.status = 403;\n            next(error);\n            return;\n        }\n    \n        req.user = decodedIdToken;\n        next();\n    }\n}"],"file":"firebase-middleware.js"}