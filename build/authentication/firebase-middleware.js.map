{"version":3,"sources":["../../src/authentication/firebase-middleware.js"],"names":["auth","require","authService","exports","requiresAuth","req","res","next","idToken","header","decodedIdToken","verifyIdToken","error","user"],"mappings":";;AAAA,MAAM,EAACA,IAAD,KAASC,QAAQ,gBAAR,CAAf;AACA,MAAMC,cAAcF,MAApB;;AAEAG,QAAQC,YAAR,GAAuB,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AAC7C,UAAMC,UAAUH,IAAII,MAAJ,CAAW,qBAAX,CAAhB;;AAEA;AACA,QAAIC,cAAJ;;AAEA,QAAI;AACAA,yBAAiB,MAAMR,YAAYS,aAAZ,CAA0BH,OAA1B,CAAvB;AACH,KAFD,CAEE,OAAOI,KAAP,EAAc;AACZL,aAAKK,KAAL;AACA;AACH;;AAEDP,QAAIQ,IAAJ,GAAWH,cAAX;AACAH;AACH,CAfD","file":"firebase-middleware.js","sourcesContent":["const {auth} = require('firebase-admin');\nconst authService = auth();\n\nexports.requiresAuth = async (req, res, next) => {\n    const idToken = req.header('FIREBASE_AUTH_TOKEN');\n\n    // https://firebase.google.com/docs/reference/admin/node/admin.auth.DecodedIdToken\n    let decodedIdToken;\n\n    try {\n        decodedIdToken = await authService.verifyIdToken(idToken);\n    } catch (error) {\n        next(error);\n        return;\n    }\n\n    req.user = decodedIdToken;\n    next();\n}"]}